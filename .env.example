###############################################################################
# Telegram-бот
###############################################################################
BOT_TOKEN=                              # ← токен BotFather
MODERATOR_CHAT_ID=                      # ← ID модераторского чата


###############################################################################
# Контроль доступа
###############################################################################
WHITELIST_USER_IDS=                     # ← юзер-ID, через запятую

###############################################################################
# Mistral API и Ollama (для семантического анализа)
###############################################################################
MISTRAL_API_KEY=                        # ← API ключ Mistral AI
EMBEDDING_MODE=ollama                      # ← api / ollama / local / disabled

# Ollama настройки (если EMBEDDING_MODE=ollama)
EMBEDDING_MODEL_ID=qllama/multilingual-e5-small  # ← ID модели для эмбеддингов
OLLAMA_MODEL=qllama/multilingual-e5-small        # ← модель Ollama (fallback to EMBEDDING_MODEL_ID)
OLLAMA_BASE_URL=http://localhost:11434  # ← URL Ollama сервера

###############################################################################
# Настройки политики модерации
###############################################################################
POLICY_MODE=semi-auto                   # ← manual / legacy-manual / semi-auto / auto
ANNOUNCE_BLOCKS=True                    # ← публиковать уведомления в чате

# Пороги meta-policy (используются PolicyEngine)
META_NOTIFY=0.65                        # ← порог уведомления модератора
META_DELETE=0.85                        # ← порог автоудаления
META_KICK=0.95                          # ← порог автобана
LEGACY_KEYWORD_THRESHOLD=0.60           # ← порог keyword в legacy режиме
LEGACY_TFIDF_THRESHOLD=0.65            # ← TF-IDF ≥ value → NOTIFY в legacy режиме

# Понижающие множители для meta-policy (умножаются на p_spam до сравнения с порогами)
META_DOWNWEIGHT_ANNOUNCEMENT=0.85       # ← пост из подключенного канала снижает p_spam
META_DOWNWEIGHT_REPLY_TO_STAFF=0.90     # ← ответ модератору/админу снижает p_spam
META_DOWNWEIGHT_WHITELIST=0.85          # ← лексика магазина/заказов/брендов снижает p_spam
META_DOWNWEIGHT_BRAND=0.70              # ← ДОП. понижение при упоминании бренда (LifeMart/ЖизньМарт, Сушкоф и др.)

# Контекст и эмбеддинги
EMBEDDING_TIMEOUT_MS=800                # ← таймаут запроса эмбеддингов (мс)
EMBEDDING_ENABLE_USER=False             # ← считать пользовательскую капсулу (дороже)
CONTEXT_HISTORY_N=4                     # ← сколько сообщений контекста подмешиваем
CONTEXT_MAX_TOKENS=512                  # ← лимит токенов для контекстной капсулы (~×4 символов)
EMBEDDING_CACHE_TTL_MIN=10              # ← TTL кэша user-эмбеддингов (мин)

# Пути к артефактам meta-классификатора (по умолчанию models/*)
CENTROIDS_PATH=models/centroids.npz
PROTOTYPES_PATH=models/prototypes.npz
META_MODEL_PATH=models/meta_model.joblib
META_CALIBRATOR_PATH=models/meta_calibrator.joblib

###############################################################################
# Обучение модели и данные
###############################################################################
RETRAIN_THRESHOLD=100                   # ← кол-во новых меток для автообучения TF-IDF

###############################################################################
# Логирование
###############################################################################
LOG_LEVEL=INFO                          # ← DEBUG / INFO / WARNING / ERROR
DETAILED_DEBUG_INFO=True
